<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostCraft — AI Instagram Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            /* Forma Rosa Colors */
            --primary: #D4A59A;
            --primary-dark: #c49485;
            --primary-light: #e8cdc6;
            --text: #333333;
            --text-light: #666666;
            --background: #ffffff;
            --background-alt: #f8f8f8;
            --border: #e0e0e0;
            --success: #4caf50;
            --error: #f44336;
            --warning: #ff9800;
            
            /* Provider colors */
            --gemini-color: #4285F4;
            --openai-color: #10A37F;
        }

        body {
            font-family: 'Karla', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: var(--text);
            background: var(--background-alt);
            min-height: 100vh;
        }

        a {
            color: var(--primary-dark);
            text-decoration: none;
        }

        a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .animate-in {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        .delay-1 { animation-delay: 0.1s; opacity: 0; }
        .delay-2 { animation-delay: 0.2s; opacity: 0; }
        .delay-3 { animation-delay: 0.3s; opacity: 0; }

        .provider-toggle {
            display: flex;
            background: var(--background-alt);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 4px;
            gap: 4px;
        }

        .provider-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-family: 'Karla', sans-serif;
        }

        .provider-btn.inactive {
            background: transparent;
            color: var(--text-light);
        }

        .provider-btn.inactive:hover {
            background: var(--background);
        }

        .provider-btn.active.gemini {
            background: var(--gemini-color);
            color: white;
        }

        .provider-btn.active.openai {
            background: var(--openai-color);
            color: white;
        }

        .free-badge {
            background: #4caf50;
            color: white;
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Button styles matching Forma Rosa */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-family: 'Karla', sans-serif;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-primary:disabled {
            background: var(--border);
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--background);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--background-alt);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useRef } = React;

        // Icons
        const SparkleIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 3v18M3 12h18M5.6 5.6l12.8 12.8M18.4 5.6L5.6 18.4"/>
            </svg>
        );

        const UploadIcon = () => (
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17,8 12,3 7,8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        );

        const CheckIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5">
                <polyline points="20,6 9,17 4,12"/>
            </svg>
        );

        const GlobeIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        // Gemini icon
        const GeminiIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
        );

        // OpenAI icon
        const OpenAIIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M22.282 9.821a5.985 5.985 0 0 0-.516-4.91 6.046 6.046 0 0 0-6.51-2.9A6.065 6.065 0 0 0 4.981 4.18a5.985 5.985 0 0 0-3.998 2.9 6.046 6.046 0 0 0 .743 7.097 5.98 5.98 0 0 0 .51 4.911 6.051 6.051 0 0 0 6.515 2.9A5.985 5.985 0 0 0 13.26 24a6.056 6.056 0 0 0 5.772-4.206 5.99 5.99 0 0 0 3.997-2.9 6.056 6.056 0 0 0-.747-7.073zM13.26 22.43a4.476 4.476 0 0 1-2.876-1.04l.141-.081 4.779-2.758a.795.795 0 0 0 .392-.681v-6.737l2.02 1.168a.071.071 0 0 1 .038.052v5.583a4.504 4.504 0 0 1-4.494 4.494zM3.6 18.304a4.47 4.47 0 0 1-.535-3.014l.142.085 4.783 2.759a.771.771 0 0 0 .78 0l5.843-3.369v2.332a.08.08 0 0 1-.033.062L9.74 19.95a4.5 4.5 0 0 1-6.14-1.646zM2.34 7.896a4.485 4.485 0 0 1 2.366-1.973V11.6a.766.766 0 0 0 .388.676l5.815 3.355-2.02 1.168a.076.076 0 0 1-.071 0l-4.83-2.786A4.504 4.504 0 0 1 2.34 7.872zm16.597 3.855l-5.833-3.387L15.119 7.2a.076.076 0 0 1 .071 0l4.83 2.791a4.494 4.494 0 0 1-.676 8.105v-5.678a.79.79 0 0 0-.407-.667zm2.01-3.023l-.141-.085-4.774-2.782a.776.776 0 0 0-.785 0L9.409 9.23V6.897a.066.066 0 0 1 .028-.061l4.83-2.787a4.5 4.5 0 0 1 6.68 4.66zm-12.64 4.135l-2.02-1.164a.08.08 0 0 1-.038-.057V6.075a4.5 4.5 0 0 1 7.375-3.453l-.142.08L8.704 5.46a.795.795 0 0 0-.393.681zm1.097-2.365l2.602-1.5 2.607 1.5v2.999l-2.597 1.5-2.607-1.5z"/>
            </svg>
        );

        // Main App Component
        function App() {
            const [provider, setProvider] = useState('gemini');
            const [brandUrl, setBrandUrl] = useState('');
            const [brandAnalysis, setBrandAnalysis] = useState(null);
            const [isAnalyzingBrand, setIsAnalyzingBrand] = useState(false);
            const [uploadedImage, setUploadedImage] = useState(null);
            const [imagePreview, setImagePreview] = useState(null);
            const [isDragging, setIsDragging] = useState(false);
            const [generatedContent, setGeneratedContent] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [apiKey, setApiKey] = useState('');
            const [showApiInput, setShowApiInput] = useState(true);
            const fileInputRef = useRef(null);

            // Call Gemini API
            const callGemini = async (prompt, imageData = null) => {
                const contents = [];
                
                if (imageData) {
                    contents.push({
                        parts: [
                            {
                                inline_data: {
                                    mime_type: imageData.mimeType,
                                    data: imageData.base64
                                }
                            },
                            { text: prompt }
                        ]
                    });
                } else {
                    contents.push({
                        parts: [{ text: prompt }]
                    });
                }

                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`,
                    {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents })
                    }
                );

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error.message);
                }
                
                return data.candidates?.[0]?.content?.parts?.[0]?.text || '';
            };

            // Call OpenAI API
            const callOpenAI = async (messages) => {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        max_tokens: 1000,
                        messages
                    })
                });

                const data = await response.json();
                return data.choices?.[0]?.message?.content || '';
            };

            // Analyze brand website
            const analyzeBrand = async () => {
                if (!brandUrl || !apiKey) return;
                
                setIsAnalyzingBrand(true);
                try {
                    const prompt = `Analyze the brand at ${brandUrl}. Based on the URL and your knowledge, understand their likely brand voice, tone, and language style. 

Provide a JSON response with:
{
    "brandName": "the brand name",
    "voiceTone": "describe their tone in 2-3 words (e.g., 'warm and professional', 'bold and playful')",
    "keyPhrases": ["3-5 phrases or words they might commonly use"],
    "targetAudience": "who they likely speak to",
    "styleNotes": "brief notes on their likely visual/content style"
}

Respond ONLY with valid JSON, no other text or markdown.`;

                    let textContent;
                    if (provider === 'gemini') {
                        textContent = await callGemini(prompt);
                    } else {
                        textContent = await callOpenAI([{ role: 'user', content: prompt }]);
                    }
                    
                    try {
                        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            setBrandAnalysis(JSON.parse(jsonMatch[0]));
                        }
                    } catch (e) {
                        setBrandAnalysis({
                            brandName: "Brand",
                            voiceTone: "Professional and friendly",
                            keyPhrases: ["quality", "innovation", "community"],
                            targetAudience: "General audience",
                            styleNotes: textContent.substring(0, 200)
                        });
                    }
                } catch (error) {
                    console.error('Brand analysis error:', error);
                    alert('Error analyzing brand: ' + error.message);
                }
                setIsAnalyzingBrand(false);
            };

            // Handle image drop
            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const file = e.dataTransfer?.files[0] || e.target?.files[0];
                if (file && file.type.startsWith('image/')) {
                    setUploadedImage(file);
                    const reader = new FileReader();
                    reader.onload = (e) => setImagePreview(e.target.result);
                    reader.readAsDataURL(file);
                }
            }, []);

            const handleDragOver = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };

            const handleDragLeave = () => setIsDragging(false);

            // Generate Instagram content
            const generateContent = async () => {
                if (!uploadedImage || !apiKey) return;
                
                setIsGenerating(true);
                try {
                    const base64 = imagePreview.split(',')[1];
                    const mediaType = uploadedImage.type;

                    const brandContext = brandAnalysis 
                        ? `Brand context: ${brandAnalysis.brandName} with a ${brandAnalysis.voiceTone} voice. They often use phrases like: ${brandAnalysis.keyPhrases?.join(', ')}. Target audience: ${brandAnalysis.targetAudience}.`
                        : 'No specific brand context provided.';

                    const prompt = `Analyze this image for an Instagram post. ${brandContext}

Provide a JSON response with:
{
    "generalColor": "the dominant/overall color mood in 1-2 words (e.g., 'warm blue', 'earthy green', 'golden')",
    "generalConcept": "what's happening in 2-4 words (e.g., 'sunset dinner', 'morning coffee ritual', 'urban adventure')",
    "postDescription": "an engaging Instagram caption (2-3 sentences) that matches the brand voice, followed by 5-8 relevant hashtags"
}

Respond ONLY with valid JSON, no other text or markdown.`;

                    let textContent;
                    if (provider === 'gemini') {
                        textContent = await callGemini(prompt, {
                            base64,
                            mimeType: mediaType
                        });
                    } else {
                        textContent = await callOpenAI([{
                            role: 'user',
                            content: [
                                {
                                    type: 'image_url',
                                    image_url: {
                                        url: `data:${mediaType};base64,${base64}`
                                    }
                                },
                                { type: 'text', text: prompt }
                            ]
                        }]);
                    }
                    
                    try {
                        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            setGeneratedContent(JSON.parse(jsonMatch[0]));
                        }
                    } catch (e) {
                        console.error('Parse error:', e);
                        setGeneratedContent({
                            generalColor: "Could not parse",
                            generalConcept: "Could not parse",
                            postDescription: textContent
                        });
                    }
                } catch (error) {
                    console.error('Generation error:', error);
                    alert('Error generating content: ' + error.message);
                }
                setIsGenerating(false);
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
            };

            const handleProviderChange = (newProvider) => {
                setProvider(newProvider);
                setApiKey('');
                setShowApiInput(true);
                setBrandAnalysis(null);
                setGeneratedContent(null);
            };

            return (
                <div style={{
                    minHeight: '100vh',
                    padding: '24px',
                    maxWidth: '1400px',
                    margin: '0 auto'
                }}>
                    {/* Header */}
                    <header className="animate-in" style={{
                        background: 'var(--background)',
                        borderBottom: '1px solid var(--border)',
                        padding: '16px 24px',
                        marginBottom: '24px',
                        borderRadius: '8px',
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        flexWrap: 'wrap',
                        gap: '16px'
                    }}>
                        <div>
                            <h1 style={{
                                fontSize: '18px',
                                fontWeight: 600,
                                color: 'var(--text)'
                            }}>
                                PostCraft
                            </h1>
                            <p style={{
                                color: 'var(--text-light)',
                                fontSize: '13px',
                                marginTop: '2px'
                            }}>
                                AI Instagram Generator
                            </p>
                        </div>
                        
                        {/* Provider Toggle in Header */}
                        <div style={{ width: '320px' }}>
                            <div className="provider-toggle">
                                <button
                                    className={`provider-btn ${provider === 'gemini' ? 'active gemini' : 'inactive'}`}
                                    onClick={() => handleProviderChange('gemini')}
                                >
                                    <GeminiIcon /> Gemini <span className="free-badge">Free</span>
                                </button>
                                <button
                                    className={`provider-btn ${provider === 'openai' ? 'active openai' : 'inactive'}`}
                                    onClick={() => handleProviderChange('openai')}
                                >
                                    <OpenAIIcon /> ChatGPT
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* API Key Input */}
                    {showApiInput && (
                        <div className="animate-in delay-1" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px',
                            marginBottom: '24px'
                        }}>
                            <label style={{
                                display: 'block',
                                fontSize: '12px',
                                fontWeight: 500,
                                marginBottom: '6px',
                                color: 'var(--text-light)'
                            }}>
                                {provider === 'gemini' ? 'Google Gemini API Key' : 'OpenAI API Key'}
                            </label>
                            <div style={{ display: 'flex', gap: '12px' }}>
                                <input
                                    type="password"
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                    placeholder={provider === 'gemini' ? 'AIza...' : 'sk-...'}
                                    style={{
                                        flex: 1,
                                        padding: '10px 12px',
                                        border: '1px solid var(--border)',
                                        borderRadius: '4px',
                                        fontSize: '14px',
                                        fontFamily: 'Karla, sans-serif',
                                        outline: 'none',
                                        transition: 'border-color 0.2s'
                                    }}
                                    onFocus={(e) => e.target.style.borderColor = 'var(--primary)'}
                                    onBlur={(e) => e.target.style.borderColor = 'var(--border)'}
                                />
                                {apiKey && (
                                    <button
                                        onClick={() => setShowApiInput(false)}
                                        className="btn btn-primary"
                                        style={{
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '6px'
                                        }}
                                    >
                                        <CheckIcon /> Save
                                    </button>
                                )}
                            </div>
                            <p style={{
                                fontSize: '12px',
                                color: 'var(--text-light)',
                                marginTop: '8px'
                            }}>
                                {provider === 'gemini' ? (
                                    <>Get your free API key at <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener noreferrer" style={{ color: 'var(--gemini-color)' }}>aistudio.google.com/apikey</a></>
                                ) : (
                                    <>Get your API key at <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer" style={{ color: 'var(--openai-color)' }}>platform.openai.com</a> (paid)</>
                                )}
                            </p>
                        </div>
                    )}

                    {/* Main Content Grid */}
                    <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(auto-fit, minmax(320px, 1fr))',
                        gap: '20px'
                    }}>
                        {/* Step 1: Brand Analysis */}
                        <div className="animate-in delay-1" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '16px'
                            }}>
                                <span style={{
                                    width: '24px',
                                    height: '24px',
                                    background: 'var(--primary-light)',
                                    color: 'var(--primary-dark)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '12px'
                                }}>1</span>
                                <h2 style={{ fontSize: '16px', fontWeight: 600 }}>
                                    Analyze Brand
                                </h2>
                                <span style={{ fontSize: '11px', color: 'var(--text-light)' }}>(optional)</span>
                            </div>

                            <p style={{
                                color: 'var(--text-light)',
                                fontSize: '13px',
                                marginBottom: '16px'
                            }}>
                                Enter your website URL to capture your brand's voice.
                            </p>

                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '8px',
                                padding: '10px 12px',
                                border: '1px solid var(--border)',
                                borderRadius: '4px',
                                background: 'white',
                                marginBottom: '12px'
                            }}>
                                <GlobeIcon />
                                <input
                                    type="url"
                                    value={brandUrl}
                                    onChange={(e) => setBrandUrl(e.target.value)}
                                    placeholder="https://yourbrand.com"
                                    style={{
                                        flex: 1,
                                        border: 'none',
                                        outline: 'none',
                                        fontSize: '14px',
                                        fontFamily: 'Karla, sans-serif'
                                    }}
                                />
                            </div>

                            <button
                                onClick={analyzeBrand}
                                disabled={!brandUrl || !apiKey || isAnalyzingBrand}
                                className="btn"
                                style={{
                                    width: '100%',
                                    background: brandUrl && apiKey ? 'var(--text)' : 'var(--border)',
                                    color: brandUrl && apiKey ? 'white' : 'var(--text-light)',
                                    cursor: brandUrl && apiKey ? 'pointer' : 'not-allowed'
                                }}
                            >
                                {isAnalyzingBrand ? 'Analyzing...' : 'Analyze Brand'}
                            </button>

                            {brandAnalysis && (
                                <div style={{
                                    marginTop: '16px',
                                    padding: '12px',
                                    background: '#e8f5e9',
                                    borderRadius: '4px',
                                    border: '1px solid var(--success)'
                                }}>
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '6px',
                                        color: 'var(--success)',
                                        fontWeight: 500,
                                        fontSize: '13px',
                                        marginBottom: '8px'
                                    }}>
                                        <CheckIcon /> Brand Analyzed
                                    </div>
                                    <p style={{ fontSize: '13px', marginBottom: '4px' }}>
                                        <strong>{brandAnalysis.brandName}</strong> — {brandAnalysis.voiceTone}
                                    </p>
                                    <p style={{ fontSize: '12px', color: 'var(--text-light)' }}>
                                        {brandAnalysis.targetAudience}
                                    </p>
                                </div>
                            )}
                        </div>

                        {/* Step 2: Image Upload */}
                        <div className="animate-in delay-2" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '16px'
                            }}>
                                <span style={{
                                    width: '24px',
                                    height: '24px',
                                    background: 'var(--primary-light)',
                                    color: 'var(--primary-dark)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '12px'
                                }}>2</span>
                                <h2 style={{ fontSize: '16px', fontWeight: 600 }}>
                                    Upload Image
                                </h2>
                            </div>

                            <div
                                onDrop={handleDrop}
                                onDragOver={handleDragOver}
                                onDragLeave={handleDragLeave}
                                onClick={() => fileInputRef.current?.click()}
                                style={{
                                    border: `2px dashed ${isDragging ? 'var(--primary)' : 'var(--border)'}`,
                                    borderRadius: '4px',
                                    padding: imagePreview ? '0' : '32px 16px',
                                    textAlign: 'center',
                                    cursor: 'pointer',
                                    transition: 'all 0.2s',
                                    background: isDragging ? 'var(--primary-light)' : 'var(--background-alt)',
                                    overflow: 'hidden',
                                    minHeight: '180px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center'
                                }}
                            >
                                {imagePreview ? (
                                    <img 
                                        src={imagePreview} 
                                        alt="Uploaded" 
                                        style={{
                                            maxWidth: '100%',
                                            maxHeight: '250px',
                                            objectFit: 'contain'
                                        }}
                                    />
                                ) : (
                                    <div>
                                        <div style={{ 
                                            color: isDragging ? 'var(--primary)' : 'var(--text-light)',
                                            marginBottom: '12px'
                                        }}>
                                            <UploadIcon />
                                        </div>
                                        <p style={{ 
                                            fontWeight: 500,
                                            marginBottom: '4px',
                                            fontSize: '14px'
                                        }}>
                                            Drop image here
                                        </p>
                                        <p style={{ 
                                            color: 'var(--text-light)',
                                            fontSize: '12px'
                                        }}>
                                            or click to browse
                                        </p>
                                    </div>
                                )}
                            </div>
                            <input
                                ref={fileInputRef}
                                type="file"
                                accept="image/*"
                                onChange={handleDrop}
                                style={{ display: 'none' }}
                            />

                            {imagePreview && (
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        setUploadedImage(null);
                                        setImagePreview(null);
                                        setGeneratedContent(null);
                                    }}
                                    className="btn btn-secondary"
                                    style={{
                                        marginTop: '12px',
                                        fontSize: '12px',
                                        padding: '6px 12px'
                                    }}
                                >
                                    Remove image
                                </button>
                            )}
                        </div>

                        {/* Step 3: Generate */}
                        <div className="animate-in delay-3" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '16px'
                            }}>
                                <span style={{
                                    width: '24px',
                                    height: '24px',
                                    background: 'var(--primary-light)',
                                    color: 'var(--primary-dark)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '12px'
                                }}>3</span>
                                <h2 style={{ fontSize: '16px', fontWeight: 600 }}>
                                    Generate
                                </h2>
                            </div>

                            <button
                                onClick={generateContent}
                                disabled={!uploadedImage || !apiKey || isGenerating}
                                className="btn btn-primary"
                                style={{
                                    width: '100%',
                                    padding: '14px 20px',
                                    fontSize: '14px',
                                    fontWeight: 600,
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    gap: '8px',
                                    background: uploadedImage && apiKey 
                                        ? (provider === 'gemini' ? 'var(--gemini-color)' : 'var(--openai-color)')
                                        : 'var(--border)',
                                    cursor: uploadedImage && apiKey ? 'pointer' : 'not-allowed'
                                }}
                            >
                                {isGenerating ? (
                                    <span style={{ animation: 'pulse 1.5s infinite' }}>Generating...</span>
                                ) : (
                                    <>
                                        <SparkleIcon /> Generate Post
                                    </>
                                )}
                            </button>

                            {generatedContent && (
                                <div style={{ marginTop: '20px' }}>
                                    {/* Color & Concept */}
                                    <div style={{
                                        display: 'flex',
                                        gap: '12px',
                                        marginBottom: '12px'
                                    }}>
                                        <div style={{
                                            flex: 1,
                                            padding: '12px',
                                            background: 'var(--background-alt)',
                                            borderRadius: '4px'
                                        }}>
                                            <label style={{
                                                fontSize: '10px',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em',
                                                color: 'var(--text-light)',
                                                display: 'block',
                                                marginBottom: '4px'
                                            }}>Color</label>
                                            <p style={{ 
                                                fontWeight: 600,
                                                fontSize: '14px'
                                            }}>{generatedContent.generalColor}</p>
                                        </div>
                                        <div style={{
                                            flex: 1,
                                            padding: '12px',
                                            background: 'var(--background-alt)',
                                            borderRadius: '4px'
                                        }}>
                                            <label style={{
                                                fontSize: '10px',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em',
                                                color: 'var(--text-light)',
                                                display: 'block',
                                                marginBottom: '4px'
                                            }}>Concept</label>
                                            <p style={{ 
                                                fontWeight: 600,
                                                fontSize: '14px'
                                            }}>{generatedContent.generalConcept}</p>
                                        </div>
                                    </div>

                                    {/* Caption */}
                                    <div style={{
                                        padding: '16px',
                                        background: 'var(--background-alt)',
                                        borderRadius: '4px',
                                        position: 'relative'
                                    }}>
                                        <label style={{
                                            fontSize: '10px',
                                            textTransform: 'uppercase',
                                            letterSpacing: '0.05em',
                                            color: 'var(--text-light)',
                                            display: 'block',
                                            marginBottom: '8px'
                                        }}>Caption & Hashtags</label>
                                        <p style={{ 
                                            lineHeight: 1.6,
                                            whiteSpace: 'pre-wrap',
                                            fontSize: '13px'
                                        }}>{generatedContent.postDescription}</p>
                                        <button
                                            onClick={() => copyToClipboard(generatedContent.postDescription)}
                                            className="btn btn-secondary"
                                            style={{
                                                position: 'absolute',
                                                top: '12px',
                                                right: '12px',
                                                padding: '4px 10px',
                                                fontSize: '11px'
                                            }}
                                        >
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Footer */}
                    <footer style={{
                        textAlign: 'center',
                        marginTop: '32px',
                        padding: '16px',
                        color: 'var(--text-light)',
                        fontSize: '13px'
                    }}>
                        <p>
                            Powered by {provider === 'gemini' ? 'Google Gemini (free)' : 'ChatGPT'}
                            {!showApiInput && (
                                <> • <a 
                                    href="#" 
                                    onClick={(e) => { e.preventDefault(); setShowApiInput(true); }}
                                    style={{ color: 'var(--primary-dark)' }}
                                >
                                    Change API Key
                                </a></>
                            )}
                        </p>
                    </footer>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
