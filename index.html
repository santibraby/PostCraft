<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostCraft — AI Instagram Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            /* Forma Rosa Colors */
            --primary: #D4A59A;
            --primary-dark: #c49485;
            --primary-light: #e8cdc6;
            --text: #333333;
            --text-light: #666666;
            --background: #ffffff;
            --background-alt: #f8f8f8;
            --border: #e0e0e0;
            --success: #4caf50;
            --error: #f44336;
            --warning: #ff9800;
            
            /* Provider colors - using brand colors */
            --gemini-color: #D4A59A;
            --openai-color: #10A37F;
        }

        body {
            font-family: 'Karla', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: var(--text);
            background: var(--background-alt);
            min-height: 100vh;
        }

        a {
            color: var(--primary-dark);
            text-decoration: none;
        }

        a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .animate-in {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        .delay-1 { animation-delay: 0.1s; opacity: 0; }
        .delay-2 { animation-delay: 0.2s; opacity: 0; }
        .delay-3 { animation-delay: 0.3s; opacity: 0; }

        .provider-toggle {
            display: flex;
            background: var(--background-alt);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 4px;
            gap: 4px;
        }

        .provider-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-family: 'Karla', sans-serif;
        }

        .provider-btn.inactive {
            background: transparent;
            color: var(--text-light);
        }

        .provider-btn.inactive:hover {
            background: var(--background);
        }

        .provider-btn.active.gemini {
            background: var(--primary);
            color: white;
        }

        .provider-btn.active.openai {
            background: var(--openai-color);
            color: white;
        }

        .free-badge {
            background: var(--success);
            color: white;
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: 600;
            text-transform: uppercase;
        }

        /* Info dot tooltip */
        .info-dot {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: var(--primary-light);
            color: var(--primary-dark);
            border-radius: 50%;
            font-size: 11px;
            font-weight: 600;
            cursor: help;
            position: relative;
            margin-left: 6px;
        }

        .info-dot:hover .tooltip {
            display: block;
        }

        .tooltip {
            display: none;
            position: absolute;
            top: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--text);
            color: white;
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 400;
            width: 280px;
            z-index: 100;
            line-height: 1.5;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .tooltip::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid var(--text);
        }

        .tooltip ol {
            margin: 8px 0 0 16px;
            padding: 0;
        }

        .tooltip li {
            margin-bottom: 4px;
        }

        .tooltip a {
            color: var(--primary-light);
        }

        /* Button styles matching Forma Rosa */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-family: 'Karla', sans-serif;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-primary:disabled {
            background: var(--border);
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--background);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--background-alt);
        }

        /* Brand analysis details */
        .brand-details {
            margin-top: 12px;
        }

        .brand-detail-row {
            display: flex;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            font-size: 12px;
        }

        .brand-detail-row:last-child {
            border-bottom: none;
        }

        .brand-detail-label {
            width: 100px;
            color: var(--text-light);
            flex-shrink: 0;
        }

        .brand-detail-value {
            color: var(--text);
        }

        .brand-keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .brand-keyword {
            background: var(--primary-light);
            color: var(--primary-dark);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useRef } = React;

        // Icons
        const SparkleIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 3v18M3 12h18M5.6 5.6l12.8 12.8M18.4 5.6L5.6 18.4"/>
            </svg>
        );

        const UploadIcon = () => (
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17,8 12,3 7,8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        );

        const CheckIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5">
                <polyline points="20,6 9,17 4,12"/>
            </svg>
        );

        const GlobeIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        // Info tooltip component
        const InfoDot = ({ children }) => (
            <span className="info-dot">
                ?
                <div className="tooltip">{children}</div>
            </span>
        );

        // Main App Component
        function App() {
            const [provider, setProvider] = useState('gemini');
            const [brandUrl, setBrandUrl] = useState('');
            const [brandAnalysis, setBrandAnalysis] = useState(null);
            const [isAnalyzingBrand, setIsAnalyzingBrand] = useState(false);
            const [uploadedImage, setUploadedImage] = useState(null);
            const [imagePreview, setImagePreview] = useState(null);
            const [isDragging, setIsDragging] = useState(false);
            const [generatedContent, setGeneratedContent] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [apiKey, setApiKey] = useState('');
            const [showApiInput, setShowApiInput] = useState(true);
            const fileInputRef = useRef(null);

            // Call Gemini API
            const callGemini = async (prompt, imageData = null) => {
                const contents = [];
                
                if (imageData) {
                    contents.push({
                        parts: [
                            {
                                inline_data: {
                                    mime_type: imageData.mimeType,
                                    data: imageData.base64
                                }
                            },
                            { text: prompt }
                        ]
                    });
                } else {
                    contents.push({
                        parts: [{ text: prompt }]
                    });
                }

                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`,
                    {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents })
                    }
                );

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error.message);
                }
                
                return data.candidates?.[0]?.content?.parts?.[0]?.text || '';
            };

            // Call OpenAI API
            const callOpenAI = async (messages) => {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        max_tokens: 1500,
                        messages
                    })
                });

                const data = await response.json();
                return data.choices?.[0]?.message?.content || '';
            };

            // Analyze brand website - DEEPER ANALYSIS
            const analyzeBrand = async () => {
                if (!brandUrl || !apiKey) return;
                
                setIsAnalyzingBrand(true);
                try {
                    const prompt = `You are a brand strategist. Analyze the brand at ${brandUrl}. Based on the URL, domain name, and your knowledge of this brand (or similar brands in the industry), provide a comprehensive brand analysis.

Think deeply about:
- What industry are they in?
- What's their likely market positioning (luxury, budget, mid-range)?
- Who would their ideal customer be?
- What emotions do they want to evoke?
- What language patterns would resonate with their audience?

Provide a JSON response with this structure:
{
    "brandName": "the brand name extracted from URL or known",
    "industry": "their industry/sector (e.g., 'Fashion & Lifestyle', 'Food & Beverage', 'Tech', 'Wellness')",
    "positioning": "market positioning in 2-3 words (e.g., 'Premium minimalist', 'Accessible luxury', 'Playful & bold')",
    "voiceTone": "describe their communication tone in 3-4 words (e.g., 'warm, authentic, and inspiring')",
    "targetAudience": "detailed description of ideal customer (e.g., 'Health-conscious millennials who value sustainability and aesthetic')",
    "emotionalAppeal": "what emotions they evoke (e.g., 'aspiration, comfort, belonging')",
    "keyPhrases": ["5-7 phrases or words that fit their brand voice"],
    "hashtagStyle": "describe their hashtag approach (e.g., 'mix of branded + community tags', 'minimal and curated')",
    "contentThemes": ["3-4 content themes they likely focus on"],
    "doNotUse": ["2-3 words or tones to avoid for this brand"]
}

Respond ONLY with valid JSON, no other text, no markdown formatting.`;

                    let textContent;
                    if (provider === 'gemini') {
                        textContent = await callGemini(prompt);
                    } else {
                        textContent = await callOpenAI([{ role: 'user', content: prompt }]);
                    }
                    
                    try {
                        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            setBrandAnalysis(JSON.parse(jsonMatch[0]));
                        }
                    } catch (e) {
                        console.error('Parse error:', e);
                        setBrandAnalysis({
                            brandName: brandUrl.replace(/https?:\/\//, '').split('/')[0],
                            industry: "Unknown",
                            positioning: "Professional",
                            voiceTone: "Professional and friendly",
                            targetAudience: "General audience",
                            emotionalAppeal: "Trust and quality",
                            keyPhrases: ["quality", "innovation", "community"],
                            hashtagStyle: "Mixed approach",
                            contentThemes: ["Products", "Lifestyle", "Community"],
                            doNotUse: ["Overly casual", "Aggressive sales"]
                        });
                    }
                } catch (error) {
                    console.error('Brand analysis error:', error);
                    alert('Error analyzing brand: ' + error.message);
                }
                setIsAnalyzingBrand(false);
            };

            // Handle image drop
            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const file = e.dataTransfer?.files[0] || e.target?.files[0];
                if (file && file.type.startsWith('image/')) {
                    setUploadedImage(file);
                    const reader = new FileReader();
                    reader.onload = (e) => setImagePreview(e.target.result);
                    reader.readAsDataURL(file);
                }
            }, []);

            const handleDragOver = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };

            const handleDragLeave = () => setIsDragging(false);

            // Generate Instagram content
            const generateContent = async () => {
                if (!uploadedImage || !apiKey) return;
                
                setIsGenerating(true);
                try {
                    const base64 = imagePreview.split(',')[1];
                    const mediaType = uploadedImage.type;

                    let brandContext = 'No specific brand context provided. Use a friendly, engaging tone.';
                    
                    if (brandAnalysis) {
                        brandContext = `Brand Context:
- Brand: ${brandAnalysis.brandName} (${brandAnalysis.industry})
- Positioning: ${brandAnalysis.positioning}
- Voice & Tone: ${brandAnalysis.voiceTone}
- Target Audience: ${brandAnalysis.targetAudience}
- Emotional Appeal: ${brandAnalysis.emotionalAppeal}
- Key Phrases to use: ${brandAnalysis.keyPhrases?.join(', ')}
- Hashtag Style: ${brandAnalysis.hashtagStyle}
- Content Themes: ${brandAnalysis.contentThemes?.join(', ')}
- Words/Tones to AVOID: ${brandAnalysis.doNotUse?.join(', ')}`;
                    }

                    const prompt = `You are a social media manager creating an Instagram post. Analyze this image and create content that perfectly matches the brand voice.

${brandContext}

Analyze the image and provide a JSON response:
{
    "generalColor": "the dominant color mood in 1-2 words (e.g., 'warm terracotta', 'cool blue', 'golden hour')",
    "generalConcept": "what's happening in 2-4 words (e.g., 'cozy morning ritual', 'urban exploration', 'sunset gathering')",
    "postDescription": "an engaging Instagram caption (2-4 sentences) that authentically matches the brand voice and connects emotionally with the target audience. Include a subtle call-to-action or question. End with 6-10 relevant hashtags that match the brand's hashtag style - mix of popular and niche tags."
}

Make the caption feel human and authentic, not salesy or generic. Respond ONLY with valid JSON, no other text or markdown.`;

                    let textContent;
                    if (provider === 'gemini') {
                        textContent = await callGemini(prompt, {
                            base64,
                            mimeType: mediaType
                        });
                    } else {
                        textContent = await callOpenAI([{
                            role: 'user',
                            content: [
                                {
                                    type: 'image_url',
                                    image_url: {
                                        url: `data:${mediaType};base64,${base64}`
                                    }
                                },
                                { type: 'text', text: prompt }
                            ]
                        }]);
                    }
                    
                    try {
                        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            setGeneratedContent(JSON.parse(jsonMatch[0]));
                        }
                    } catch (e) {
                        console.error('Parse error:', e);
                        setGeneratedContent({
                            generalColor: "Could not parse",
                            generalConcept: "Could not parse",
                            postDescription: textContent
                        });
                    }
                } catch (error) {
                    console.error('Generation error:', error);
                    alert('Error generating content: ' + error.message);
                }
                setIsGenerating(false);
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
            };

            const handleProviderChange = (newProvider) => {
                setProvider(newProvider);
                setApiKey('');
                setShowApiInput(true);
                setBrandAnalysis(null);
                setGeneratedContent(null);
            };

            return (
                <div style={{
                    minHeight: '100vh',
                    padding: '24px',
                    maxWidth: '1400px',
                    margin: '0 auto'
                }}>
                    {/* Header */}
                    <header className="animate-in" style={{
                        background: 'var(--background)',
                        borderBottom: '1px solid var(--border)',
                        padding: '16px 24px',
                        marginBottom: '24px',
                        borderRadius: '8px',
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        flexWrap: 'wrap',
                        gap: '16px'
                    }}>
                        <div>
                            <h1 style={{
                                fontSize: '18px',
                                fontWeight: 600,
                                color: 'var(--text)'
                            }}>
                                PostCraft
                            </h1>
                            <p style={{
                                color: 'var(--text-light)',
                                fontSize: '13px',
                                marginTop: '2px'
                            }}>
                                AI Instagram Generator
                            </p>
                        </div>
                        
                        {/* Provider Toggle in Header */}
                        <div style={{ width: '320px' }}>
                            <div className="provider-toggle">
                                <button
                                    className={`provider-btn ${provider === 'gemini' ? 'active gemini' : 'inactive'}`}
                                    onClick={() => handleProviderChange('gemini')}
                                >
                                    Gemini <span className="free-badge">Free</span>
                                </button>
                                <button
                                    className={`provider-btn ${provider === 'openai' ? 'active openai' : 'inactive'}`}
                                    onClick={() => handleProviderChange('openai')}
                                >
                                    ChatGPT
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* API Key Input */}
                    {showApiInput && (
                        <div className="animate-in delay-1" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px',
                            marginBottom: '24px'
                        }}>
                            <label style={{
                                display: 'flex',
                                alignItems: 'center',
                                fontSize: '12px',
                                fontWeight: 500,
                                marginBottom: '6px',
                                color: 'var(--text-light)'
                            }}>
                                {provider === 'gemini' ? 'Google Gemini API Key' : 'OpenAI API Key'}
                                {provider === 'gemini' && (
                                    <InfoDot>
                                        <strong>How to get your free API key:</strong>
                                        <ol>
                                            <li>Go to <a href="https://aistudio.google.com/apikey" target="_blank">aistudio.google.com/apikey</a></li>
                                            <li>Sign in with your Google account</li>
                                            <li>Click "Create API Key"</li>
                                            <li>Copy the key (starts with AIza...)</li>
                                        </ol>
                                        <div style={{ marginTop: '8px', opacity: 0.8 }}>
                                            No credit card needed. 250 free requests/day.
                                        </div>
                                    </InfoDot>
                                )}
                            </label>
                            <div style={{ display: 'flex', gap: '12px' }}>
                                <input
                                    type="password"
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                    placeholder={provider === 'gemini' ? 'AIza...' : 'sk-...'}
                                    style={{
                                        flex: 1,
                                        padding: '10px 12px',
                                        border: '1px solid var(--border)',
                                        borderRadius: '4px',
                                        fontSize: '14px',
                                        fontFamily: 'Karla, sans-serif',
                                        outline: 'none',
                                        transition: 'border-color 0.2s'
                                    }}
                                    onFocus={(e) => e.target.style.borderColor = 'var(--primary)'}
                                    onBlur={(e) => e.target.style.borderColor = 'var(--border)'}
                                />
                                {apiKey && (
                                    <button
                                        onClick={() => setShowApiInput(false)}
                                        className="btn btn-primary"
                                        style={{
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '6px'
                                        }}
                                    >
                                        <CheckIcon /> Save
                                    </button>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Main Content Grid */}
                    <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(auto-fit, minmax(320px, 1fr))',
                        gap: '20px'
                    }}>
                        {/* Step 1: Brand Analysis */}
                        <div className="animate-in delay-1" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '16px'
                            }}>
                                <span style={{
                                    width: '24px',
                                    height: '24px',
                                    background: 'var(--primary-light)',
                                    color: 'var(--primary-dark)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '12px'
                                }}>1</span>
                                <h2 style={{ fontSize: '16px', fontWeight: 600 }}>
                                    Analyze Brand
                                </h2>
                                <span style={{ fontSize: '11px', color: 'var(--text-light)' }}>(optional)</span>
                            </div>

                            <p style={{
                                color: 'var(--text-light)',
                                fontSize: '13px',
                                marginBottom: '16px'
                            }}>
                                Enter your website URL for a deep brand voice analysis.
                            </p>

                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '8px',
                                padding: '10px 12px',
                                border: '1px solid var(--border)',
                                borderRadius: '4px',
                                background: 'white',
                                marginBottom: '12px'
                            }}>
                                <GlobeIcon />
                                <input
                                    type="url"
                                    value={brandUrl}
                                    onChange={(e) => setBrandUrl(e.target.value)}
                                    placeholder="https://yourbrand.com"
                                    style={{
                                        flex: 1,
                                        border: 'none',
                                        outline: 'none',
                                        fontSize: '14px',
                                        fontFamily: 'Karla, sans-serif'
                                    }}
                                />
                            </div>

                            <button
                                onClick={analyzeBrand}
                                disabled={!brandUrl || !apiKey || isAnalyzingBrand}
                                className="btn"
                                style={{
                                    width: '100%',
                                    background: brandUrl && apiKey ? 'var(--text)' : 'var(--border)',
                                    color: brandUrl && apiKey ? 'white' : 'var(--text-light)',
                                    cursor: brandUrl && apiKey ? 'pointer' : 'not-allowed'
                                }}
                            >
                                {isAnalyzingBrand ? 'Analyzing...' : 'Analyze Brand'}
                            </button>

                            {brandAnalysis && (
                                <div style={{
                                    marginTop: '16px',
                                    padding: '12px',
                                    background: '#e8f5e9',
                                    borderRadius: '4px',
                                    border: '1px solid var(--success)'
                                }}>
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '6px',
                                        color: 'var(--success)',
                                        fontWeight: 600,
                                        fontSize: '13px',
                                        marginBottom: '8px'
                                    }}>
                                        <CheckIcon /> {brandAnalysis.brandName}
                                    </div>
                                    
                                    <div className="brand-details">
                                        <div className="brand-detail-row">
                                            <span className="brand-detail-label">Industry</span>
                                            <span className="brand-detail-value">{brandAnalysis.industry}</span>
                                        </div>
                                        <div className="brand-detail-row">
                                            <span className="brand-detail-label">Positioning</span>
                                            <span className="brand-detail-value">{brandAnalysis.positioning}</span>
                                        </div>
                                        <div className="brand-detail-row">
                                            <span className="brand-detail-label">Voice</span>
                                            <span className="brand-detail-value">{brandAnalysis.voiceTone}</span>
                                        </div>
                                        <div className="brand-detail-row">
                                            <span className="brand-detail-label">Audience</span>
                                            <span className="brand-detail-value">{brandAnalysis.targetAudience}</span>
                                        </div>
                                        <div className="brand-detail-row">
                                            <span className="brand-detail-label">Key phrases</span>
                                            <div className="brand-keywords">
                                                {brandAnalysis.keyPhrases?.slice(0, 5).map((phrase, i) => (
                                                    <span key={i} className="brand-keyword">{phrase}</span>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Step 2: Image Upload */}
                        <div className="animate-in delay-2" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '16px'
                            }}>
                                <span style={{
                                    width: '24px',
                                    height: '24px',
                                    background: 'var(--primary-light)',
                                    color: 'var(--primary-dark)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '12px'
                                }}>2</span>
                                <h2 style={{ fontSize: '16px', fontWeight: 600 }}>
                                    Upload Image
                                </h2>
                            </div>

                            <div
                                onDrop={handleDrop}
                                onDragOver={handleDragOver}
                                onDragLeave={handleDragLeave}
                                onClick={() => fileInputRef.current?.click()}
                                style={{
                                    border: `2px dashed ${isDragging ? 'var(--primary)' : 'var(--border)'}`,
                                    borderRadius: '4px',
                                    padding: imagePreview ? '0' : '32px 16px',
                                    textAlign: 'center',
                                    cursor: 'pointer',
                                    transition: 'all 0.2s',
                                    background: isDragging ? 'var(--primary-light)' : 'var(--background-alt)',
                                    overflow: 'hidden',
                                    minHeight: '180px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center'
                                }}
                            >
                                {imagePreview ? (
                                    <img 
                                        src={imagePreview} 
                                        alt="Uploaded" 
                                        style={{
                                            maxWidth: '100%',
                                            maxHeight: '250px',
                                            objectFit: 'contain'
                                        }}
                                    />
                                ) : (
                                    <div>
                                        <div style={{ 
                                            color: isDragging ? 'var(--primary)' : 'var(--text-light)',
                                            marginBottom: '12px'
                                        }}>
                                            <UploadIcon />
                                        </div>
                                        <p style={{ 
                                            fontWeight: 500,
                                            marginBottom: '4px',
                                            fontSize: '14px'
                                        }}>
                                            Drop image here
                                        </p>
                                        <p style={{ 
                                            color: 'var(--text-light)',
                                            fontSize: '12px'
                                        }}>
                                            or click to browse
                                        </p>
                                    </div>
                                )}
                            </div>
                            <input
                                ref={fileInputRef}
                                type="file"
                                accept="image/*"
                                onChange={handleDrop}
                                style={{ display: 'none' }}
                            />

                            {imagePreview && (
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        setUploadedImage(null);
                                        setImagePreview(null);
                                        setGeneratedContent(null);
                                    }}
                                    className="btn btn-secondary"
                                    style={{
                                        marginTop: '12px',
                                        fontSize: '12px',
                                        padding: '6px 12px'
                                    }}
                                >
                                    Remove image
                                </button>
                            )}
                        </div>

                        {/* Step 3: Generate */}
                        <div className="animate-in delay-3" style={{
                            background: 'var(--background)',
                            border: '1px solid var(--border)',
                            borderRadius: '8px',
                            padding: '20px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                marginBottom: '16px'
                            }}>
                                <span style={{
                                    width: '24px',
                                    height: '24px',
                                    background: 'var(--primary-light)',
                                    color: 'var(--primary-dark)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '12px'
                                }}>3</span>
                                <h2 style={{ fontSize: '16px', fontWeight: 600 }}>
                                    Generate
                                </h2>
                            </div>

                            <button
                                onClick={generateContent}
                                disabled={!uploadedImage || !apiKey || isGenerating}
                                className="btn btn-primary"
                                style={{
                                    width: '100%',
                                    padding: '14px 20px',
                                    fontSize: '14px',
                                    fontWeight: 600,
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    gap: '8px',
                                    background: uploadedImage && apiKey 
                                        ? 'var(--primary)'
                                        : 'var(--border)',
                                    cursor: uploadedImage && apiKey ? 'pointer' : 'not-allowed'
                                }}
                            >
                                {isGenerating ? (
                                    <span style={{ animation: 'pulse 1.5s infinite' }}>Generating...</span>
                                ) : (
                                    <>
                                        <SparkleIcon /> Generate Post
                                    </>
                                )}
                            </button>

                            {generatedContent && (
                                <div style={{ marginTop: '20px' }}>
                                    {/* Color & Concept */}
                                    <div style={{
                                        display: 'flex',
                                        gap: '12px',
                                        marginBottom: '12px'
                                    }}>
                                        <div style={{
                                            flex: 1,
                                            padding: '12px',
                                            background: 'var(--background-alt)',
                                            borderRadius: '4px'
                                        }}>
                                            <label style={{
                                                fontSize: '10px',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em',
                                                color: 'var(--text-light)',
                                                display: 'block',
                                                marginBottom: '4px'
                                            }}>Color</label>
                                            <p style={{ 
                                                fontWeight: 600,
                                                fontSize: '14px'
                                            }}>{generatedContent.generalColor}</p>
                                        </div>
                                        <div style={{
                                            flex: 1,
                                            padding: '12px',
                                            background: 'var(--background-alt)',
                                            borderRadius: '4px'
                                        }}>
                                            <label style={{
                                                fontSize: '10px',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em',
                                                color: 'var(--text-light)',
                                                display: 'block',
                                                marginBottom: '4px'
                                            }}>Concept</label>
                                            <p style={{ 
                                                fontWeight: 600,
                                                fontSize: '14px'
                                            }}>{generatedContent.generalConcept}</p>
                                        </div>
                                    </div>

                                    {/* Caption */}
                                    <div style={{
                                        padding: '16px',
                                        background: 'var(--background-alt)',
                                        borderRadius: '4px',
                                        position: 'relative'
                                    }}>
                                        <label style={{
                                            fontSize: '10px',
                                            textTransform: 'uppercase',
                                            letterSpacing: '0.05em',
                                            color: 'var(--text-light)',
                                            display: 'block',
                                            marginBottom: '8px'
                                        }}>Caption & Hashtags</label>
                                        <p style={{ 
                                            lineHeight: 1.6,
                                            whiteSpace: 'pre-wrap',
                                            fontSize: '13px'
                                        }}>{generatedContent.postDescription}</p>
                                        <button
                                            onClick={() => copyToClipboard(generatedContent.postDescription)}
                                            className="btn btn-secondary"
                                            style={{
                                                position: 'absolute',
                                                top: '12px',
                                                right: '12px',
                                                padding: '4px 10px',
                                                fontSize: '11px'
                                            }}
                                        >
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Footer */}
                    <footer style={{
                        textAlign: 'center',
                        marginTop: '32px',
                        padding: '16px',
                        color: 'var(--text-light)',
                        fontSize: '13px'
                    }}>
                        <p>
                            Powered by {provider === 'gemini' ? 'Google Gemini' : 'ChatGPT'}
                            {!showApiInput && (
                                <> • <a 
                                    href="#" 
                                    onClick={(e) => { e.preventDefault(); setShowApiInput(true); }}
                                    style={{ color: 'var(--primary-dark)' }}
                                >
                                    Change API Key
                                </a></>
                            )}
                        </p>
                    </footer>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
