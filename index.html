<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostCraft — AI Instagram Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg-primary: #FAF9F7;
            --bg-secondary: #FFFFFF;
            --text-primary: #1A1A1A;
            --text-secondary: #6B6B6B;
            --accent: #E85D04;
            --accent-light: #FFF4ED;
            --border: #E8E6E3;
            --success: #2D6A4F;
            --success-light: #D8F3DC;
            --claude-color: #D97706;
            --openai-color: #10A37F;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .serif {
            font-family: 'Instrument Serif', serif;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .animate-in {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        .delay-1 { animation-delay: 0.1s; opacity: 0; }
        .delay-2 { animation-delay: 0.2s; opacity: 0; }
        .delay-3 { animation-delay: 0.3s; opacity: 0; }

        .provider-toggle {
            display: flex;
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 4px;
            gap: 4px;
        }

        .provider-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: inherit;
        }

        .provider-btn.inactive {
            background: transparent;
            color: var(--text-secondary);
        }

        .provider-btn.active.claude {
            background: var(--claude-color);
            color: white;
        }

        .provider-btn.active.openai {
            background: var(--openai-color);
            color: white;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useRef } = React;

        // Icons
        const SparkleIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 3v18M3 12h18M5.6 5.6l12.8 12.8M18.4 5.6L5.6 18.4"/>
            </svg>
        );

        const UploadIcon = () => (
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17,8 12,3 7,8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        );

        const CheckIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5">
                <polyline points="20,6 9,17 4,12"/>
            </svg>
        );

        const GlobeIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        // Claude logo
        const ClaudeLogo = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
        );

        // OpenAI logo
        const OpenAILogo = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M22.282 9.821a5.985 5.985 0 0 0-.516-4.91 6.046 6.046 0 0 0-6.51-2.9A6.065 6.065 0 0 0 4.981 4.18a5.985 5.985 0 0 0-3.998 2.9 6.046 6.046 0 0 0 .743 7.097 5.98 5.98 0 0 0 .51 4.911 6.051 6.051 0 0 0 6.515 2.9A5.985 5.985 0 0 0 13.26 24a6.056 6.056 0 0 0 5.772-4.206 5.99 5.99 0 0 0 3.997-2.9 6.056 6.056 0 0 0-.747-7.073zM13.26 22.43a4.476 4.476 0 0 1-2.876-1.04l.141-.081 4.779-2.758a.795.795 0 0 0 .392-.681v-6.737l2.02 1.168a.071.071 0 0 1 .038.052v5.583a4.504 4.504 0 0 1-4.494 4.494zM3.6 18.304a4.47 4.47 0 0 1-.535-3.014l.142.085 4.783 2.759a.771.771 0 0 0 .78 0l5.843-3.369v2.332a.08.08 0 0 1-.033.062L9.74 19.95a4.5 4.5 0 0 1-6.14-1.646zM2.34 7.896a4.485 4.485 0 0 1 2.366-1.973V11.6a.766.766 0 0 0 .388.676l5.815 3.355-2.02 1.168a.076.076 0 0 1-.071 0l-4.83-2.786A4.504 4.504 0 0 1 2.34 7.872zm16.597 3.855l-5.833-3.387L15.119 7.2a.076.076 0 0 1 .071 0l4.83 2.791a4.494 4.494 0 0 1-.676 8.105v-5.678a.79.79 0 0 0-.407-.667zm2.01-3.023l-.141-.085-4.774-2.782a.776.776 0 0 0-.785 0L9.409 9.23V6.897a.066.066 0 0 1 .028-.061l4.83-2.787a4.5 4.5 0 0 1 6.68 4.66zm-12.64 4.135l-2.02-1.164a.08.08 0 0 1-.038-.057V6.075a4.5 4.5 0 0 1 7.375-3.453l-.142.08L8.704 5.46a.795.795 0 0 0-.393.681zm1.097-2.365l2.602-1.5 2.607 1.5v2.999l-2.597 1.5-2.607-1.5z"/>
            </svg>
        );

        // Main App Component
        function App() {
            const [provider, setProvider] = useState('claude'); // 'claude' or 'openai'
            const [brandUrl, setBrandUrl] = useState('');
            const [brandAnalysis, setBrandAnalysis] = useState(null);
            const [isAnalyzingBrand, setIsAnalyzingBrand] = useState(false);
            const [uploadedImage, setUploadedImage] = useState(null);
            const [imagePreview, setImagePreview] = useState(null);
            const [isDragging, setIsDragging] = useState(false);
            const [generatedContent, setGeneratedContent] = useState(null);
            const [isGenerating, setIsGenerating] = useState(false);
            const [apiKey, setApiKey] = useState('');
            const [showApiInput, setShowApiInput] = useState(true);
            const fileInputRef = useRef(null);

            const accentColor = provider === 'claude' ? 'var(--claude-color)' : 'var(--openai-color)';

            // Call Claude API
            const callClaude = async (messages, useWebSearch = false) => {
                const body = {
                    model: 'claude-sonnet-4-20250514',
                    max_tokens: 1000,
                    messages
                };
                
                if (useWebSearch) {
                    body.tools = [{
                        type: 'web_search_20250305',
                        name: 'web_search'
                    }];
                }

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': apiKey,
                        'anthropic-version': '2023-06-01',
                        'anthropic-dangerous-direct-browser-access': 'true'
                    },
                    body: JSON.stringify(body)
                });

                const data = await response.json();
                return data.content?.find(c => c.type === 'text')?.text || '';
            };

            // Call OpenAI API
            const callOpenAI = async (messages) => {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        max_tokens: 1000,
                        messages
                    })
                });

                const data = await response.json();
                return data.choices?.[0]?.message?.content || '';
            };

            // Analyze brand website
            const analyzeBrand = async () => {
                if (!brandUrl || !apiKey) return;
                
                setIsAnalyzingBrand(true);
                try {
                    const prompt = `Analyze the brand at ${brandUrl}. Research their website and understand their brand voice, tone, and language style. 

Provide a JSON response with:
{
    "brandName": "the brand name",
    "voiceTone": "describe their tone in 2-3 words (e.g., 'warm and professional', 'bold and playful')",
    "keyPhrases": ["3-5 phrases or words they commonly use"],
    "targetAudience": "who they speak to",
    "styleNotes": "brief notes on their visual/content style"
}

Respond ONLY with valid JSON, no other text.`;

                    let textContent;
                    if (provider === 'claude') {
                        textContent = await callClaude([{ role: 'user', content: prompt }], true);
                    } else {
                        textContent = await callOpenAI([{ role: 'user', content: prompt }]);
                    }
                    
                    // Try to parse JSON from response
                    try {
                        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            setBrandAnalysis(JSON.parse(jsonMatch[0]));
                        }
                    } catch (e) {
                        setBrandAnalysis({
                            brandName: "Brand",
                            voiceTone: "Professional and friendly",
                            keyPhrases: ["quality", "innovation", "community"],
                            targetAudience: "General audience",
                            styleNotes: textContent.substring(0, 200)
                        });
                    }
                } catch (error) {
                    console.error('Brand analysis error:', error);
                    alert('Error analyzing brand. Please check your API key and try again.');
                }
                setIsAnalyzingBrand(false);
            };

            // Handle image drop
            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const file = e.dataTransfer?.files[0] || e.target?.files[0];
                if (file && file.type.startsWith('image/')) {
                    setUploadedImage(file);
                    const reader = new FileReader();
                    reader.onload = (e) => setImagePreview(e.target.result);
                    reader.readAsDataURL(file);
                }
            }, []);

            const handleDragOver = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };

            const handleDragLeave = () => setIsDragging(false);

            // Generate Instagram content
            const generateContent = async () => {
                if (!uploadedImage || !apiKey) return;
                
                setIsGenerating(true);
                try {
                    const base64 = imagePreview.split(',')[1];
                    const mediaType = uploadedImage.type;

                    const brandContext = brandAnalysis 
                        ? `Brand context: ${brandAnalysis.brandName} with a ${brandAnalysis.voiceTone} voice. They often use phrases like: ${brandAnalysis.keyPhrases?.join(', ')}. Target audience: ${brandAnalysis.targetAudience}.`
                        : 'No specific brand context provided.';

                    const prompt = `Analyze this image for an Instagram post. ${brandContext}

Provide a JSON response with:
{
    "generalColor": "the dominant/overall color mood in 1-2 words (e.g., 'warm blue', 'earthy green', 'golden')",
    "generalConcept": "what's happening in 2-4 words (e.g., 'sunset dinner', 'morning coffee ritual', 'urban adventure')",
    "postDescription": "an engaging Instagram caption (2-3 sentences) that matches the brand voice, followed by 5-8 relevant hashtags"
}

Respond ONLY with valid JSON, no other text.`;

                    let textContent;
                    if (provider === 'claude') {
                        textContent = await callClaude([{
                            role: 'user',
                            content: [
                                {
                                    type: 'image',
                                    source: {
                                        type: 'base64',
                                        media_type: mediaType,
                                        data: base64
                                    }
                                },
                                { type: 'text', text: prompt }
                            ]
                        }]);
                    } else {
                        textContent = await callOpenAI([{
                            role: 'user',
                            content: [
                                {
                                    type: 'image_url',
                                    image_url: {
                                        url: `data:${mediaType};base64,${base64}`
                                    }
                                },
                                { type: 'text', text: prompt }
                            ]
                        }]);
                    }
                    
                    try {
                        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
                        if (jsonMatch) {
                            setGeneratedContent(JSON.parse(jsonMatch[0]));
                        }
                    } catch (e) {
                        console.error('Parse error:', e);
                        setGeneratedContent({
                            generalColor: "Could not parse",
                            generalConcept: "Could not parse",
                            postDescription: textContent
                        });
                    }
                } catch (error) {
                    console.error('Generation error:', error);
                    alert('Error generating content. Please check your API key and try again.');
                }
                setIsGenerating(false);
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
            };

            const handleProviderChange = (newProvider) => {
                setProvider(newProvider);
                setApiKey('');
                setShowApiInput(true);
                setBrandAnalysis(null);
                setGeneratedContent(null);
            };

            return (
                <div style={{
                    minHeight: '100vh',
                    padding: '40px 20px',
                    maxWidth: '1200px',
                    margin: '0 auto'
                }}>
                    {/* Header */}
                    <header className="animate-in" style={{
                        textAlign: 'center',
                        marginBottom: '40px'
                    }}>
                        <h1 className="serif" style={{
                            fontSize: 'clamp(2.5rem, 5vw, 4rem)',
                            fontWeight: 400,
                            marginBottom: '12px',
                            letterSpacing: '-0.02em'
                        }}>
                            Post<span style={{ color: accentColor }}>Craft</span>
                        </h1>
                        <p style={{
                            color: 'var(--text-secondary)',
                            fontSize: '1.1rem',
                            maxWidth: '500px',
                            margin: '0 auto'
                        }}>
                            AI-powered Instagram content that speaks your brand's language
                        </p>
                    </header>

                    {/* Provider Toggle */}
                    <div className="animate-in" style={{
                        maxWidth: '400px',
                        margin: '0 auto 32px'
                    }}>
                        <label style={{
                            display: 'block',
                            fontSize: '0.85rem',
                            fontWeight: 500,
                            marginBottom: '8px',
                            color: 'var(--text-secondary)',
                            textAlign: 'center'
                        }}>
                            Choose AI Provider
                        </label>
                        <div className="provider-toggle">
                            <button
                                className={`provider-btn ${provider === 'claude' ? 'active claude' : 'inactive'}`}
                                onClick={() => handleProviderChange('claude')}
                            >
                                <ClaudeLogo /> Claude
                            </button>
                            <button
                                className={`provider-btn ${provider === 'openai' ? 'active openai' : 'inactive'}`}
                                onClick={() => handleProviderChange('openai')}
                            >
                                <OpenAILogo /> ChatGPT
                            </button>
                        </div>
                    </div>

                    {/* API Key Input */}
                    {showApiInput && (
                        <div className="animate-in delay-1" style={{
                            background: 'var(--bg-secondary)',
                            border: '1px solid var(--border)',
                            borderRadius: '16px',
                            padding: '24px',
                            marginBottom: '32px',
                            maxWidth: '600px',
                            margin: '0 auto 32px'
                        }}>
                            <label style={{
                                display: 'block',
                                fontSize: '0.85rem',
                                fontWeight: 500,
                                marginBottom: '8px',
                                color: 'var(--text-secondary)'
                            }}>
                                {provider === 'claude' ? 'Anthropic API Key' : 'OpenAI API Key'}
                            </label>
                            <div style={{ display: 'flex', gap: '12px' }}>
                                <input
                                    type="password"
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                    placeholder={provider === 'claude' ? 'sk-ant-...' : 'sk-...'}
                                    style={{
                                        flex: 1,
                                        padding: '14px 18px',
                                        border: '1px solid var(--border)',
                                        borderRadius: '10px',
                                        fontSize: '1rem',
                                        fontFamily: 'inherit',
                                        outline: 'none',
                                        transition: 'border-color 0.2s'
                                    }}
                                    onFocus={(e) => e.target.style.borderColor = accentColor}
                                    onBlur={(e) => e.target.style.borderColor = 'var(--border)'}
                                />
                                {apiKey && (
                                    <button
                                        onClick={() => setShowApiInput(false)}
                                        style={{
                                            padding: '14px 24px',
                                            background: 'var(--success)',
                                            color: 'white',
                                            border: 'none',
                                            borderRadius: '10px',
                                            cursor: 'pointer',
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '8px',
                                            fontWeight: 500
                                        }}
                                    >
                                        <CheckIcon /> Save
                                    </button>
                                )}
                            </div>
                            <p style={{
                                fontSize: '0.8rem',
                                color: 'var(--text-secondary)',
                                marginTop: '10px'
                            }}>
                                Your key is stored locally and never sent anywhere except {provider === 'claude' ? "Anthropic's" : "OpenAI's"} API.
                            </p>
                        </div>
                    )}

                    {/* Main Content Grid */}
                    <div style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(auto-fit, minmax(340px, 1fr))',
                        gap: '24px'
                    }}>
                        {/* Step 1: Brand Analysis */}
                        <div className="animate-in delay-1" style={{
                            background: 'var(--bg-secondary)',
                            border: '1px solid var(--border)',
                            borderRadius: '20px',
                            padding: '32px',
                            transition: 'box-shadow 0.3s'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '12px',
                                marginBottom: '20px'
                            }}>
                                <span style={{
                                    width: '32px',
                                    height: '32px',
                                    background: provider === 'claude' ? '#FEF3C7' : '#D1FAE5',
                                    color: accentColor,
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '0.9rem'
                                }}>1</span>
                                <h2 style={{ fontSize: '1.25rem', fontWeight: 500 }}>
                                    Analyze Your Brand
                                </h2>
                            </div>

                            <p style={{
                                color: 'var(--text-secondary)',
                                fontSize: '0.95rem',
                                marginBottom: '20px'
                            }}>
                                Enter your website URL to capture your brand's unique voice and style.
                                {provider === 'openai' && (
                                    <span style={{ display: 'block', marginTop: '8px', fontSize: '0.85rem', fontStyle: 'italic' }}>
                                        Note: ChatGPT will infer brand style from URL and general knowledge.
                                    </span>
                                )}
                            </p>

                            <div style={{ display: 'flex', gap: '10px', marginBottom: '16px' }}>
                                <div style={{
                                    flex: 1,
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '10px',
                                    padding: '14px 18px',
                                    border: '1px solid var(--border)',
                                    borderRadius: '10px',
                                    background: 'white'
                                }}>
                                    <GlobeIcon />
                                    <input
                                        type="url"
                                        value={brandUrl}
                                        onChange={(e) => setBrandUrl(e.target.value)}
                                        placeholder="https://yourbrand.com"
                                        style={{
                                            flex: 1,
                                            border: 'none',
                                            outline: 'none',
                                            fontSize: '1rem',
                                            fontFamily: 'inherit'
                                        }}
                                    />
                                </div>
                            </div>

                            <button
                                onClick={analyzeBrand}
                                disabled={!brandUrl || !apiKey || isAnalyzingBrand}
                                style={{
                                    width: '100%',
                                    padding: '14px 24px',
                                    background: brandUrl && apiKey ? 'var(--text-primary)' : 'var(--border)',
                                    color: brandUrl && apiKey ? 'white' : 'var(--text-secondary)',
                                    border: 'none',
                                    borderRadius: '10px',
                                    fontSize: '1rem',
                                    fontWeight: 500,
                                    cursor: brandUrl && apiKey ? 'pointer' : 'not-allowed',
                                    transition: 'all 0.2s'
                                }}
                            >
                                {isAnalyzingBrand ? 'Analyzing...' : 'Analyze Brand Voice'}
                            </button>

                            {brandAnalysis && (
                                <div style={{
                                    marginTop: '20px',
                                    padding: '16px',
                                    background: 'var(--success-light)',
                                    borderRadius: '12px',
                                    border: '1px solid var(--success)'
                                }}>
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '8px',
                                        color: 'var(--success)',
                                        fontWeight: 500,
                                        marginBottom: '10px'
                                    }}>
                                        <CheckIcon /> Brand Analyzed
                                    </div>
                                    <p style={{ fontSize: '0.9rem', marginBottom: '8px' }}>
                                        <strong>{brandAnalysis.brandName}</strong> — {brandAnalysis.voiceTone}
                                    </p>
                                    <p style={{ fontSize: '0.85rem', color: 'var(--text-secondary)' }}>
                                        {brandAnalysis.targetAudience}
                                    </p>
                                </div>
                            )}
                        </div>

                        {/* Step 2: Image Upload */}
                        <div className="animate-in delay-2" style={{
                            background: 'var(--bg-secondary)',
                            border: '1px solid var(--border)',
                            borderRadius: '20px',
                            padding: '32px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '12px',
                                marginBottom: '20px'
                            }}>
                                <span style={{
                                    width: '32px',
                                    height: '32px',
                                    background: provider === 'claude' ? '#FEF3C7' : '#D1FAE5',
                                    color: accentColor,
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '0.9rem'
                                }}>2</span>
                                <h2 style={{ fontSize: '1.25rem', fontWeight: 500 }}>
                                    Upload Image
                                </h2>
                            </div>

                            <div
                                onDrop={handleDrop}
                                onDragOver={handleDragOver}
                                onDragLeave={handleDragLeave}
                                onClick={() => fileInputRef.current?.click()}
                                style={{
                                    border: `2px dashed ${isDragging ? accentColor : 'var(--border)'}`,
                                    borderRadius: '16px',
                                    padding: imagePreview ? '0' : '48px 24px',
                                    textAlign: 'center',
                                    cursor: 'pointer',
                                    transition: 'all 0.2s',
                                    background: isDragging ? (provider === 'claude' ? '#FEF3C7' : '#D1FAE5') : 'transparent',
                                    overflow: 'hidden',
                                    minHeight: '200px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center'
                                }}
                            >
                                {imagePreview ? (
                                    <img 
                                        src={imagePreview} 
                                        alt="Uploaded" 
                                        style={{
                                            maxWidth: '100%',
                                            maxHeight: '300px',
                                            objectFit: 'contain'
                                        }}
                                    />
                                ) : (
                                    <div>
                                        <div style={{ 
                                            color: isDragging ? accentColor : 'var(--text-secondary)',
                                            marginBottom: '16px'
                                        }}>
                                            <UploadIcon />
                                        </div>
                                        <p style={{ 
                                            fontWeight: 500,
                                            marginBottom: '8px'
                                        }}>
                                            Drop your image here
                                        </p>
                                        <p style={{ 
                                            color: 'var(--text-secondary)',
                                            fontSize: '0.9rem'
                                        }}>
                                            or click to browse
                                        </p>
                                    </div>
                                )}
                            </div>
                            <input
                                ref={fileInputRef}
                                type="file"
                                accept="image/*"
                                onChange={handleDrop}
                                style={{ display: 'none' }}
                            />

                            {imagePreview && (
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        setUploadedImage(null);
                                        setImagePreview(null);
                                        setGeneratedContent(null);
                                    }}
                                    style={{
                                        marginTop: '12px',
                                        padding: '8px 16px',
                                        background: 'transparent',
                                        border: '1px solid var(--border)',
                                        borderRadius: '8px',
                                        cursor: 'pointer',
                                        fontSize: '0.9rem',
                                        color: 'var(--text-secondary)'
                                    }}
                                >
                                    Remove image
                                </button>
                            )}
                        </div>

                        {/* Step 3: Generate */}
                        <div className="animate-in delay-3" style={{
                            background: 'var(--bg-secondary)',
                            border: '1px solid var(--border)',
                            borderRadius: '20px',
                            padding: '32px'
                        }}>
                            <div style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '12px',
                                marginBottom: '20px'
                            }}>
                                <span style={{
                                    width: '32px',
                                    height: '32px',
                                    background: provider === 'claude' ? '#FEF3C7' : '#D1FAE5',
                                    color: accentColor,
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontWeight: 600,
                                    fontSize: '0.9rem'
                                }}>3</span>
                                <h2 style={{ fontSize: '1.25rem', fontWeight: 500 }}>
                                    Generate Content
                                </h2>
                            </div>

                            <button
                                onClick={generateContent}
                                disabled={!uploadedImage || !apiKey || isGenerating}
                                style={{
                                    width: '100%',
                                    padding: '18px 24px',
                                    background: uploadedImage && apiKey 
                                        ? (provider === 'claude' 
                                            ? 'linear-gradient(135deg, #D97706 0%, #B45309 100%)'
                                            : 'linear-gradient(135deg, #10A37F 0%, #0D8A6A 100%)')
                                        : 'var(--border)',
                                    color: uploadedImage && apiKey ? 'white' : 'var(--text-secondary)',
                                    border: 'none',
                                    borderRadius: '12px',
                                    fontSize: '1.1rem',
                                    fontWeight: 600,
                                    cursor: uploadedImage && apiKey ? 'pointer' : 'not-allowed',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    gap: '10px',
                                    transition: 'all 0.3s',
                                    boxShadow: uploadedImage && apiKey 
                                        ? (provider === 'claude'
                                            ? '0 4px 20px rgba(217, 119, 6, 0.3)'
                                            : '0 4px 20px rgba(16, 163, 127, 0.3)')
                                        : 'none'
                                }}
                            >
                                {isGenerating ? (
                                    <span style={{ animation: 'pulse 1.5s infinite' }}>Generating...</span>
                                ) : (
                                    <>
                                        <SparkleIcon /> Generate Post
                                    </>
                                )}
                            </button>

                            {generatedContent && (
                                <div style={{ marginTop: '24px' }}>
                                    {/* Color & Concept Tags */}
                                    <div style={{
                                        display: 'flex',
                                        gap: '12px',
                                        marginBottom: '16px'
                                    }}>
                                        <div style={{
                                            flex: 1,
                                            padding: '16px',
                                            background: 'var(--bg-primary)',
                                            borderRadius: '12px'
                                        }}>
                                            <label style={{
                                                fontSize: '0.75rem',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em',
                                                color: 'var(--text-secondary)',
                                                display: 'block',
                                                marginBottom: '6px'
                                            }}>Color</label>
                                            <p style={{ 
                                                fontWeight: 500,
                                                fontSize: '1.1rem'
                                            }}>{generatedContent.generalColor}</p>
                                        </div>
                                        <div style={{
                                            flex: 1,
                                            padding: '16px',
                                            background: 'var(--bg-primary)',
                                            borderRadius: '12px'
                                        }}>
                                            <label style={{
                                                fontSize: '0.75rem',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em',
                                                color: 'var(--text-secondary)',
                                                display: 'block',
                                                marginBottom: '6px'
                                            }}>Concept</label>
                                            <p style={{ 
                                                fontWeight: 500,
                                                fontSize: '1.1rem'
                                            }}>{generatedContent.generalConcept}</p>
                                        </div>
                                    </div>

                                    {/* Caption */}
                                    <div style={{
                                        padding: '20px',
                                        background: 'var(--bg-primary)',
                                        borderRadius: '12px',
                                        position: 'relative'
                                    }}>
                                        <label style={{
                                            fontSize: '0.75rem',
                                            textTransform: 'uppercase',
                                            letterSpacing: '0.05em',
                                            color: 'var(--text-secondary)',
                                            display: 'block',
                                            marginBottom: '10px'
                                        }}>Caption & Hashtags</label>
                                        <p style={{ 
                                            lineHeight: 1.7,
                                            whiteSpace: 'pre-wrap'
                                        }}>{generatedContent.postDescription}</p>
                                        <button
                                            onClick={() => copyToClipboard(generatedContent.postDescription)}
                                            style={{
                                                position: 'absolute',
                                                top: '16px',
                                                right: '16px',
                                                padding: '8px 14px',
                                                background: 'var(--text-primary)',
                                                color: 'white',
                                                border: 'none',
                                                borderRadius: '8px',
                                                fontSize: '0.8rem',
                                                cursor: 'pointer',
                                                fontWeight: 500
                                            }}
                                        >
                                            Copy
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Footer */}
                    <footer style={{
                        textAlign: 'center',
                        marginTop: '60px',
                        padding: '24px',
                        color: 'var(--text-secondary)',
                        fontSize: '0.9rem'
                    }}>
                        <p>
                            Powered by {provider === 'claude' ? 'Claude' : 'ChatGPT'} • 
                            Paste your {provider === 'claude' ? 'Anthropic' : 'OpenAI'} API key to get started
                        </p>
                        {!showApiInput && (
                            <button
                                onClick={() => setShowApiInput(true)}
                                style={{
                                    marginTop: '8px',
                                    background: 'none',
                                    border: 'none',
                                    color: accentColor,
                                    cursor: 'pointer',
                                    textDecoration: 'underline'
                                }}
                            >
                                Change API Key
                            </button>
                        )}
                    </footer>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
